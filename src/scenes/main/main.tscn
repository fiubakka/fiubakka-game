[gd_scene load_steps=16 format=3 uid="uid://bwgonn6l2afs6"]

[ext_resource type="Script" path="res://src/scenes/main/main.gd" id="1_kecny"]
[ext_resource type="PackedScene" uid="uid://b6kg7qutp1h00" path="res://src/scenes/login/login.tscn" id="3_2am71"]
[ext_resource type="Script" path="res://src/scenes/main/server/server_connection.gd" id="3_ffkqj"]
[ext_resource type="Script" path="res://src/scenes/main/server/server_consumer.gd" id="4_gxvl4"]
[ext_resource type="Script" path="res://src/scenes/main/server/server_producer.gd" id="5_xlac2"]
[ext_resource type="PackedScene" uid="uid://oihrx253mx55" path="res://src/scenes/GUI/chatbox/chatbox.tscn" id="6_q0kgv"]
[ext_resource type="PackedScene" uid="uid://dv7baj7ykjngg" path="res://src/scenes/GUI/pause/pause.tscn" id="7_2ia4i"]
[ext_resource type="PackedScene" uid="uid://2focfqtvt576" path="res://src/scenes/character_creation/character_creation.tscn" id="8_veqb1"]
[ext_resource type="PackedScene" uid="uid://dpkjmhxodrn0l" path="res://src/scenes/main_menu/main_menu.tscn" id="9_hsq23"]
[ext_resource type="PackedScene" uid="uid://bjdyuheqlnwho" path="res://src/scenes/GUI/GUIManager/GuiManager.tscn" id="10_2hml5"]
[ext_resource type="PackedScene" uid="uid://nqpqnx1lgim3" path="res://src/scenes/game_menu/GameMenu.tscn" id="10_8b4g2"]
[ext_resource type="PackedScene" uid="uid://ci2j6myp2y3u3" path="res://src/scenes/GUI/dialogue/Dialogue.tscn" id="11_bkedh"]
[ext_resource type="PackedScene" uid="uid://dj80f5e6d1tsp" path="res://src/scenes/GUI/modal/modal.tscn" id="12_3el8v"]
[ext_resource type="PackedScene" uid="uid://btx655wwmsnrl" path="res://src/scenes/language_select/language_select.tscn" id="13_geu0e"]
[ext_resource type="Script" path="res://src/scenes/main/MusicPlayer.gd" id="16_u85st"]

[node name="Main" type="Node2D"]
position = Vector2(0, 3)
script = ExtResource("1_kecny")

[node name="Login" parent="." instance=ExtResource("3_2am71")]
visible = false
custom_minimum_size = Vector2(960, 540)
offset_top = -3.0
offset_right = 960.0
offset_bottom = 537.0

[node name="Register" parent="." instance=ExtResource("8_veqb1")]
visible = false

[node name="ServerConnection" type="Node" parent="."]
script = ExtResource("3_ffkqj")

[node name="ServerConsumer" type="Node" parent="ServerConnection"]
script = ExtResource("4_gxvl4")

[node name="ServerProducer" type="Node" parent="ServerConnection"]
script = ExtResource("5_xlac2")

[node name="GUI" type="CanvasLayer" parent="."]

[node name="GuiManager" parent="GUI" instance=ExtResource("10_2hml5")]
offset_top = 3.0
offset_bottom = 3.0

[node name="Chatbox" parent="GUI/GuiManager" instance=ExtResource("6_q0kgv")]
visible = false
layout_mode = 1
anchors_preset = -1
anchor_left = 1.0
anchor_top = 1.0
anchor_right = 1.0
anchor_bottom = 1.0
offset_left = 520.0
offset_top = 274.0
offset_right = 950.0
offset_bottom = 523.0
grow_horizontal = 0
grow_vertical = 0

[node name="GameMenu" parent="GUI/GuiManager" instance=ExtResource("10_8b4g2")]
visible = false
layout_mode = 1
offset_left = 214.0
offset_top = 94.0
offset_right = 214.0
offset_bottom = 94.0

[node name="Pause" parent="GUI/GuiManager" instance=ExtResource("7_2ia4i")]
visible = false
offset_left = 2.0
offset_top = -3.0
offset_right = 42.0
offset_bottom = 37.0

[node name="NpcTip" parent="GUI/GuiManager" instance=ExtResource("11_bkedh")]
visible = false
layout_mode = 1
offset_top = 400.0
offset_bottom = 400.0

[node name="Modal" parent="GUI/GuiManager" instance=ExtResource("12_3el8v")]
visible = false
layout_mode = 1

[node name="MainMenu" parent="." instance=ExtResource("9_hsq23")]
visible = false
offset_left = 1.0
offset_top = -3.0
offset_right = 959.0
offset_bottom = 537.0

[node name="LanguageSelect" parent="." instance=ExtResource("13_geu0e")]
anchors_preset = 0
anchor_right = 0.0
anchor_bottom = 0.0
offset_top = -3.0
offset_right = 960.0
offset_bottom = 537.0
grow_horizontal = 1
grow_vertical = 1

[node name="MusicPlayer" type="AudioStreamPlayer" parent="."]
volume_db = 1.0
script = ExtResource("16_u85st")

[connection signal="login_ready" from="." to="GUI/GuiManager/Chatbox" method="_on_main_login_ready"]
[connection signal="login_ready" from="." to="GUI/GuiManager/Pause" method="_on_main_login_ready"]
[connection signal="login_ready" from="." to="MusicPlayer" method="_on_main_login_ready"]
[connection signal="return_to_menu" from="Login" to="." method="_on_login_return_to_menu"]
[connection signal="user_logged_in" from="Login" to="ServerConnection/ServerProducer" method="_on_user_logged_in"]
[connection signal="return_to_menu" from="Register" to="." method="_on_register_return_to_menu"]
[connection signal="user_logged_in" from="Register" to="ServerConnection/ServerProducer" method="_on_user_logged_in"]
[connection signal="start_truco_music" from="ServerConnection/ServerConsumer" to="MusicPlayer" method="_on_start_truco_music"]
[connection signal="truco_challenge_received" from="ServerConnection/ServerConsumer" to="GUI/GuiManager/Modal" method="_on_server_consumer_truco_challenge_received"]
[connection signal="update_content" from="ServerConnection/ServerConsumer" to="GUI/GuiManager/Chatbox" method="_on_server_consumer_update_content"]
[connection signal="user_init_error" from="ServerConnection/ServerConsumer" to="Login" method="_on_user_init_error"]
[connection signal="user_init_error" from="ServerConnection/ServerConsumer" to="Register" method="_on_user_init_error"]
[connection signal="user_init_ready" from="ServerConnection/ServerConsumer" to="." method="_on_server_consumer_user_init_ready"]
[connection signal="user_init_ready" from="ServerConnection/ServerConsumer" to="GUI/GuiManager/GameMenu/HBoxContainer/NinePatchRect/CenterContainer/Panel/Inventory" method="_on_server_consumer_user_init_ready"]
[connection signal="start_truco_music" from="ServerConnection/ServerProducer" to="MusicPlayer" method="_on_start_truco_music"]
[connection signal="ui_opened" from="GUI/GuiManager" to="." method="_on_gui_manager_ui_opened"]
[connection signal="is_focused" from="GUI/GuiManager/Chatbox" to="GUI/GuiManager" method="_on_chatbox_is_focused"]
[connection signal="send_message" from="GUI/GuiManager/Chatbox" to="ServerConnection/ServerProducer" method="_on_chatbox_send_message"]
[connection signal="update_equipment" from="GUI/GuiManager/GameMenu/HBoxContainer/NinePatchRect/CenterContainer/Panel/Inventory" to="ServerConnection/ServerProducer" method="_on_inventory_update_equipment"]
[connection signal="unpaused" from="GUI/GuiManager/Pause" to="." method="_on_pause_unpaused"]
[connection signal="match_accepted" from="GUI/GuiManager/Modal" to="ServerConnection/ServerProducer" method="_on_modal_match_accepted"]
[connection signal="match_rejected" from="GUI/GuiManager/Modal" to="ServerConnection/ServerProducer" method="_on_modal_match_rejected"]
[connection signal="go_to_login" from="MainMenu" to="." method="_on_main_menu_go_to_login"]
[connection signal="go_to_login" from="MainMenu" to="Login/NinePatchRect/VBoxContainer/LoginButtonContainer/LoginErrorText" method="_on_error_clear"]
[connection signal="go_to_register" from="MainMenu" to="." method="_on_main_menu_go_to_register"]
[connection signal="go_to_register" from="MainMenu" to="Register/NinePatchRect/VBoxContainer/Character/Left/Username/RegisterErrorText" method="_on_error_clear"]
[connection signal="go_to_main_menu" from="LanguageSelect" to="MainMenu" method="_on_language_select_go_to_main_menu"]
[connection signal="switch_locale" from="LanguageSelect" to="Login/NinePatchRect/VBoxContainer/LoginButtonContainer/LoginButtonBorder/LoginTextContainer/LoginText" method="_on_language_select_switch_locale"]
[connection signal="switch_locale" from="LanguageSelect" to="Register/NinePatchRect/VBoxContainer/MarginContainer/RegisterTitleText" method="_on_language_select_switch_locale"]
[connection signal="switch_locale" from="LanguageSelect" to="Register/NinePatchRect/VBoxContainer/Character/VSplitContainer/Selectors/HatsSelect" method="_on_language_select_switch_locale"]
[connection signal="switch_locale" from="LanguageSelect" to="Register/NinePatchRect/VBoxContainer/Character/VSplitContainer/Selectors/HairSelect" method="_on_language_select_switch_locale"]
[connection signal="switch_locale" from="LanguageSelect" to="Register/NinePatchRect/VBoxContainer/Character/VSplitContainer/Selectors/EyesSelect" method="_on_language_select_switch_locale"]
[connection signal="switch_locale" from="LanguageSelect" to="Register/NinePatchRect/VBoxContainer/Character/VSplitContainer/Selectors/GlassesSelect" method="_on_language_select_switch_locale"]
[connection signal="switch_locale" from="LanguageSelect" to="Register/NinePatchRect/VBoxContainer/Character/VSplitContainer/Selectors/FacialHairSelect" method="_on_language_select_switch_locale"]
[connection signal="switch_locale" from="LanguageSelect" to="Register/NinePatchRect/VBoxContainer/Character/VSplitContainer/Selectors/BodySelect" method="_on_language_select_switch_locale"]
[connection signal="switch_locale" from="LanguageSelect" to="Register/NinePatchRect/VBoxContainer/Character/VSplitContainer/Selectors/OutfitSelect" method="_on_language_select_switch_locale"]
[connection signal="switch_locale" from="LanguageSelect" to="Register/NinePatchRect/VBoxContainer/Character/VSplitContainer/HSplitContainer/Register/NinePatchRect/RegisterButtonText" method="_on_language_select_switch_locale"]
[connection signal="switch_locale" from="LanguageSelect" to="GUI/GuiManager/Pause/NinePatchRect/ContinueButton/ContinueButtonText" method="_on_language_select_switch_locale"]
[connection signal="switch_locale" from="LanguageSelect" to="GUI/GuiManager/Pause/NinePatchRect/QuitButton/QuitButtonText" method="_on_language_select_switch_locale"]

[editable path="GUI/GuiManager/GameMenu"]
